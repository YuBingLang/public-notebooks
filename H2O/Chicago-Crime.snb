{"metadata":{"id":"22534083-bfe2-4cd6-a344-8a16357c466e","name":"Chicago-Crime","user_save_timestamp":"1970-01-01T01:00:00.000Z","auto_save_timestamp":"1970-01-01T01:00:00.000Z","language_info":{"name":"scala","file_extension":"scala","codemirror_mode":"text/x-scala"},"trusted":true,"sparkNotebook":null,"customLocalRepo":"/tmp/spark-notebook","customRepos":["mvnnew % default % http://central.maven.org/maven2/ % maven"],"customDeps":["ai.h2o % sparkling-water-core_2.11 % 2.0.2","ai.h2o % sparkling-water-examples_2.11 % 2.0.2","- org.apache.hadoop % hadoop-client %   _","- org.apache.spark  % spark-core_2.11    %   _","- org.apache.spark % spark-mllib_2.11 % _","- org.apache.spark % spark-repl_2.11 % _","- org.scala-lang    %     _         %   _","- org.scoverage     %     _         %   _","- org.eclipse.jetty.aggregate % jetty-servlet % _"],"customImports":null,"customArgs":null,"customSparkConf":{"spark.ext.h2o.repl.enabled":"false","spark.ext.h2o.port.base":54321},"customVars":null},"cells":[{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"C510B88F6B3A4372B9673C8AA2353D4D"},"cell_type":"markdown","source":"### Intro:\n\nThis example is the Chicago Crime demo [1] of H2O Sparkling-water that is integrated into the spark-notebook. In this notebook we will see:\n\n- how to perform some text parsing\n- how to build H2OFrame/DataFrame from complex object classes\n- how to join two tables using spark SQL\n- how to split a dataset into a training, validation and test sets\n- how to define, train and use Deeplearning and Gradient Boosting models\n- how to merge back model predictions and features into a single table\n\nPlease note that this code was tested with Scala [2.11.8] and Spark [2.0.2]\n\n*[1] https://github.com/h2oai/sparkling-water/blob/master/examples/scripts/chicagoCrimeSmall.script.scala\n\n"},{"metadata":{"id":"9BF7E9800E2A41219E9D2EBA38014E46"},"cell_type":"markdown","source":"### Metadata\n\nIn order to work properly, this notebook requires some edition of the metadata, in particular you should add the custom dependencies (as bellow) in order to load H2O and avoid interferences with spark versions. \nNote that we also have to load dependencies from sparkling-water-examples, as scala REPL isn't able to handle new MRTask classes.\nYou also need to pass custom spark config parameters inorder to disable H2O REPL and to specify the port of the H2O Flow UI.\n\n```\n\"customLocalRepo\": \"/tmp/spark-notebook\",\n\"customDeps\": [\n  \"ai.h2o % sparkling-water-core_2.11 % 2.0.2\",\n  \"ai.h2o % sparkling-water-examples_2.11 % 2.0.2\",\n  \"- org.apache.hadoop % hadoop-client %   _\",\n  \"- org.apache.spark  % spark-core_2.11    %   _\",\n  \"- org.apache.spark % spark-mllib_2.11 % _\",\n  \"- org.apache.spark % spark-repl_2.11 % _\",\n  \"- org.scala-lang    %     _         %   _\",\n  \"- org.scoverage     %     _         %   _\",\n  \"- org.eclipse.jetty.aggregate % jetty-servlet % _\"\n],\n\"customSparkConf\": {\n  \"spark.ext.h2o.repl.enabled\": \"false\",\n  \"spark.ext.h2o.port.base\": 54321\n},\n```\n\nDon't forget to restart the kernel after you changed the metadata"},{"metadata":{"id":"E1BD82A27EB6482D8182E11EEE507F5C"},"cell_type":"markdown","source":"### Imports:\nImports the H2O packages that we will need"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"81C6B058063644B48529E267A0C2253D"},"cell_type":"code","source":"import org.apache.commons.io.FileUtils\nimport org.apache.spark.SparkFiles\nimport org.apache.spark.h2o._\nimport org.apache.spark.sql.{DataFrame, SQLContext, Row}\n\nimport org.joda.time.DateTimeConstants._\nimport org.joda.time.format.DateTimeFormat\nimport org.joda.time.{DateTimeZone, MutableDateTime}\nimport water.Key\nimport water.MRTask\nimport water.fvec.{Chunk, NewChunk, Vec}\nimport water.parser.{BufferedString, ParseSetup}\nimport water.support.{H2OFrameSupport, ModelMetricsSupport, SparkContextSupport, SparklingWaterApp}\nimport water.support.H2OFrameSupport._\n\nimport java.io.File\nimport scala.util.Try\n\nimport org.apache.spark.examples.h2o.{Crime, ChicagoCrimeApp, RefineDateColumn} //needed to define MRTask","outputs":[{"name":"stdout","output_type":"stream","text":"import org.apache.commons.io.FileUtils\nimport org.apache.spark.SparkFiles\nimport org.apache.spark.h2o._\nimport org.apache.spark.sql.{DataFrame, SQLContext, Row}\nimport org.joda.time.DateTimeConstants._\nimport org.joda.time.format.DateTimeFormat\nimport org.joda.time.{DateTimeZone, MutableDateTime}\nimport water.Key\nimport water.MRTask\nimport water.fvec.{Chunk, NewChunk, Vec}\nimport water.parser.{BufferedString, ParseSetup}\nimport water.support.{H2OFrameSupport, ModelMetricsSupport, SparkContextSupport, SparklingWaterApp}\nimport water.support.H2OFrameSupport._\nimport java.io.File\nimport scala.util.Try\nimport org.apache.spark.examples.h2o.{Crime, ChicagoCrimeApp, RefineDateColumn}\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":1,"time":"Took: 2 seconds 207 milliseconds, at 2017-1-23 13:23"}]},{"metadata":{"id":"8526594A3E6346E5889E74687BAE63D6"},"cell_type":"markdown","source":"### Contexts\n\nWe prepare the SQL and H2O Contexts that we will need later"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"36F8611D99B3450BB8EB0A50454664EB"},"cell_type":"code","source":"implicit val sqlContext = sparkSession.sqlContext\nimport sqlContext.implicits._\n\nval h2oContext = H2OContext.getOrCreate(sparkSession.sparkContext)\nimport h2oContext._\n\nimport h2oContext.implicits._","outputs":[{"name":"stdout","output_type":"stream","text":"sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@529f4e14\nimport sqlContext.implicits._\nh2oContext: org.apache.spark.h2o.H2OContext =\n\nSparkling Water Context:\n * H2O name: sparkling-water-loicus_-1922454924\n * cluster size: 1\n * list of used nodes:\n  (executorId, host, port)\n  ------------------------\n  (driver,192.168.0.13,54321)\n  ------------------------\n\n  Open H2O Flow in browser: http://192.168.0.13:54321 (CMD + click in Mac OSX)\n\nimport h2oContext._\nimport h2oContext.implicits._\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":2,"time":"Took: 9 seconds 113 milliseconds, at 2017-1-23 13:23"}]},{"metadata":{"id":"2F55B510124D4FC88CF107540349521C"},"cell_type":"markdown","source":"### Helper functions\n\nWe define a helper function to lock and update H2O Frames\n"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"884354DB2EF346E38CEE279730FB59F8"},"cell_type":"code","source":"def withLockAndUpdate[T <: Frame](fr: T)(f: T => Any): T = {\n  fr.write_lock()\n  f(fr)\n  // Update frame in DKV\n  fr.update()\n  fr.unlock()\n  fr\n}","outputs":[{"name":"stdout","output_type":"stream","text":"withLockAndUpdate: [T <: org.apache.spark.h2o.Frame](fr: T)(f: T => Any)T\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":3,"time":"Took: 3 seconds 683 milliseconds, at 2017-1-23 13:23"}]},{"metadata":{"id":"638A2EC7370D42A4858EA6CECFBCB22D"},"cell_type":"markdown","source":"### Weather Data\n\n- We download the weather data from the URL to a temporary local file\n- We create a H2OFrame from the local file using the super-fast advanced H2O CSV parser\n- We drop the first column of the Frame\n- We create and register a SQL table from the H2OFrame\n- We show the first 10 rows of the table\n"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"presentation":{"tabs_state":"{\n  \"tab_id\": \"#tab247879080-0\"\n}","pivot_chart_state":"{\n  \"hiddenAttributes\": [],\n  \"menuLimit\": 200,\n  \"cols\": [],\n  \"rows\": [],\n  \"vals\": [],\n  \"exclusions\": {},\n  \"inclusions\": {},\n  \"unusedAttrsVertical\": 85,\n  \"autoSortUnusedAttrs\": false,\n  \"inclusionsInfo\": {},\n  \"aggregatorName\": \"Count\",\n  \"rendererName\": \"Table\"\n}"},"id":"250EE40BE9E240858E7167C207425A6F"},"cell_type":"code","source":"val weatherURL = new java.net.URL(\"https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/chicagoAllWeather.csv\")\nval weatherFile = new File(\"/tmp/spark-notebook/chicagoAllWeather.csv\");\nFileUtils.copyURLToFile(weatherURL, weatherFile) //download the file from URL\nval weatherFrame:H2OFrame = new H2OFrame(weatherFile)\nwithLockAndUpdate(weatherFrame){  \n  _.remove(0).remove() // Remove first column since we do not need it\n}\nval weatherTable = asDataFrame(weatherFrame)(sqlContext)\nweatherTable.createOrReplaceTempView(\"chicagoWeather\")\n\nweatherTable.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"weatherURL: java.net.URL = https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/chicagoAllWeather.csv\nweatherFile: java.io.File = /tmp/spark-notebook/chicagoAllWeather.csv\nweatherFrame: org.apache.spark.h2o.H2OFrame =\nFrame key: chicagoAllWeather.hex\n   cols: 6\n   rows: 5162\n chunks: 32\n   size: 41861\n\nweatherTable: org.apache.spark.sql.DataFrame = [month: tinyint, day: tinyint ... 4 more fields]\nres4: Array[org.apache.spark.sql.Row] = Array([1,1,2001,23,14,6], [1,2,2001,18,12,6], [1,3,2001,28,18,8], [1,4,2001,30,24,19], [1,5,2001,36,30,21], [1,6,2001,33,26,19], [1,7,2001,34,28,21], [1,8,2001,26,20,14], [1,9,2001,23,16,10], [1,10,2001,34,26,19])\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon5f359cb3034b4c9127b5b475723b6e48&quot;,&quot;dataInit&quot;:[],&quot;genId&quot;:&quot;247879080&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <div>\n        <ul class=\"nav nav-tabs\" id=\"ul247879080\"><li>\n              <a href=\"#tab247879080-0\"><i class=\"fa fa-table\"/></a>\n            </li><li>\n              <a href=\"#tab247879080-1\"><i class=\"fa fa-cubes\"/></a>\n            </li></ul>\n\n        <div class=\"tab-content\" id=\"tab247879080\"><div class=\"tab-pane\" id=\"tab247879080-0\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonc346a301fc1e4d6faa6c605ab1a4f39c&quot;,&quot;dataInit&quot;:[{&quot;maxTemp&quot;:&quot;23&quot;,&quot;minTemp&quot;:&quot;6&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;14&quot;,&quot;day&quot;:&quot;1&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;18&quot;,&quot;minTemp&quot;:&quot;6&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;12&quot;,&quot;day&quot;:&quot;2&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;28&quot;,&quot;minTemp&quot;:&quot;8&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;18&quot;,&quot;day&quot;:&quot;3&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;30&quot;,&quot;minTemp&quot;:&quot;19&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;24&quot;,&quot;day&quot;:&quot;4&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;36&quot;,&quot;minTemp&quot;:&quot;21&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;30&quot;,&quot;day&quot;:&quot;5&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;33&quot;,&quot;minTemp&quot;:&quot;19&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;26&quot;,&quot;day&quot;:&quot;6&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;34&quot;,&quot;minTemp&quot;:&quot;21&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;28&quot;,&quot;day&quot;:&quot;7&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;26&quot;,&quot;minTemp&quot;:&quot;14&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;20&quot;,&quot;day&quot;:&quot;8&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;23&quot;,&quot;minTemp&quot;:&quot;10&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;16&quot;,&quot;day&quot;:&quot;9&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;34&quot;,&quot;minTemp&quot;:&quot;19&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;26&quot;,&quot;day&quot;:&quot;10&quot;,&quot;month&quot;:&quot;1&quot;}],&quot;genId&quot;:&quot;1232931036&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"month\",\"day\",\"year\",\"maxTemp\",\"meanTemp\",\"minTemp\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anona021290d1e40a023b462fe529425f08d&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonf9c020bc6e5aece6a9768f971d9b828c&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab247879080-1\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon7d4d5e7f158712760b425f9651a2d909&quot;,&quot;dataInit&quot;:[{&quot;maxTemp&quot;:&quot;23&quot;,&quot;minTemp&quot;:&quot;6&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;14&quot;,&quot;day&quot;:&quot;1&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;18&quot;,&quot;minTemp&quot;:&quot;6&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;12&quot;,&quot;day&quot;:&quot;2&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;28&quot;,&quot;minTemp&quot;:&quot;8&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;18&quot;,&quot;day&quot;:&quot;3&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;30&quot;,&quot;minTemp&quot;:&quot;19&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;24&quot;,&quot;day&quot;:&quot;4&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;36&quot;,&quot;minTemp&quot;:&quot;21&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;30&quot;,&quot;day&quot;:&quot;5&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;33&quot;,&quot;minTemp&quot;:&quot;19&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;26&quot;,&quot;day&quot;:&quot;6&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;34&quot;,&quot;minTemp&quot;:&quot;21&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;28&quot;,&quot;day&quot;:&quot;7&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;26&quot;,&quot;minTemp&quot;:&quot;14&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;20&quot;,&quot;day&quot;:&quot;8&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;23&quot;,&quot;minTemp&quot;:&quot;10&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;16&quot;,&quot;day&quot;:&quot;9&quot;,&quot;month&quot;:&quot;1&quot;},{&quot;maxTemp&quot;:&quot;34&quot;,&quot;minTemp&quot;:&quot;19&quot;,&quot;year&quot;:&quot;2001&quot;,&quot;meanTemp&quot;:&quot;26&quot;,&quot;day&quot;:&quot;10&quot;,&quot;month&quot;:&quot;1&quot;}],&quot;genId&quot;:&quot;1168682383&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pivotChart'], \n      function(playground, _magicpivotChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpivotChart,\n    \"o\": {\"width\":600,\"height\":400,\"derivedAttributes\":{},\"extraOptions\":{}}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc92136d7c5e1012396984b52239f6da2&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon0c6e0278f23777ffcf90c79e334a5b0c&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div></div>\n      </div>\n    </div></div>"},"output_type":"execute_result","execution_count":4,"time":"Took: 6 seconds 404 milliseconds, at 2017-1-23 13:23"}]},{"metadata":{"id":"1978DC26548345A9A78E9C5F7ADEF6B1"},"cell_type":"markdown","source":"### Census Data\n\n- We download the census data from the URL to a temporary local file\n- We create a H2OFrame from the local file using the super-fast advanced H2O CSV parser\n- We clean the column titles to avoid white space or + symbols in it.\n- We create and register a SQL table from the H2OFrame\n- We show the first 10 rows of the table"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"presentation":{"tabs_state":"{\n  \"tab_id\": \"#tab2138699297-0\"\n}","pivot_chart_state":"{\n  \"hiddenAttributes\": [],\n  \"menuLimit\": 200,\n  \"cols\": [],\n  \"rows\": [],\n  \"vals\": [],\n  \"exclusions\": {},\n  \"inclusions\": {},\n  \"unusedAttrsVertical\": 85,\n  \"autoSortUnusedAttrs\": false,\n  \"inclusionsInfo\": {},\n  \"aggregatorName\": \"Count\",\n  \"rendererName\": \"Table\"\n}"},"id":"3C7467AE247B48949B19967F4256F01D"},"cell_type":"code","source":"val censusURL = new java.net.URL(\"https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/chicagoCensus.csv\")\nval censusFile = new File(\"/tmp/spark-notebook/chicagoCensus.csv\");\nFileUtils.copyURLToFile(censusURL, censusFile) //download the file from URL\nval censusFrame:H2OFrame = new H2OFrame(censusFile)\nwithLockAndUpdate(censusFrame){  fr =>\n  // Rename columns: replace ' ' by '_'\n  val colNames = fr.names().map( n => n.trim.replace(' ', '_').replace('+','_'))\n  fr._names = colNames\n}\nval censusTable = asDataFrame(censusFrame)(sqlContext)\ncensusTable.createOrReplaceTempView(\"chicagoCensus\")\n\ncensusTable.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"censusURL: java.net.URL = https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/chicagoCensus.csv\ncensusFile: java.io.File = /tmp/spark-notebook/chicagoCensus.csv\ncensusFrame: org.apache.spark.h2o.H2OFrame =\nFrame key: chicagoCensus.hex\n   cols: 9\n   rows: 78\n chunks: 1\n   size: 3119\n\ncensusTable: org.apache.spark.sql.DataFrame = [Community_Area_Number: tinyint, COMMUNITY_AREA_NAME: string ... 7 more fields]\nres6: Array[org.apache.spark.sql.Row] = Array([1,Rogers Park,7.7,23.6,8.700000000000001,18.2,27.5,23939,39], [2,West Ridge,7.800000000000001,17.2,8.8,20.8,38.5,23040,46], [3,Uptown,3.8000000000000003,24.0,8.9,11.8,22.200000000000003,35787,20], [4,Lincoln Square,3.4000000000000004,10.9,8.200000000000001,13.4,25.5,37524,17], [5,North Center,0.30000000000000..."},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon499e4bc1765b0e8c75a5b7b2beab0529&quot;,&quot;dataInit&quot;:[],&quot;genId&quot;:&quot;2138699297&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <div>\n        <ul class=\"nav nav-tabs\" id=\"ul2138699297\"><li>\n              <a href=\"#tab2138699297-0\"><i class=\"fa fa-table\"/></a>\n            </li><li>\n              <a href=\"#tab2138699297-1\"><i class=\"fa fa-cubes\"/></a>\n            </li></ul>\n\n        <div class=\"tab-content\" id=\"tab2138699297\"><div class=\"tab-pane\" id=\"tab2138699297-0\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon7d2173c9ddb76800cedec7750bf4ae7a&quot;,&quot;dataInit&quot;:[{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:7.7,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.700000000000001,&quot;HARDSHIP_INDEX&quot;:&quot;39&quot;,&quot;Community_Area_Number&quot;:&quot;1&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Rogers Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:27.5,&quot;PER_CAPITA_INCOME&quot;:23939,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:18.2,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:23.6},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:7.800000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.8,&quot;HARDSHIP_INDEX&quot;:&quot;46&quot;,&quot;Community_Area_Number&quot;:&quot;2&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;West Ridge&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:38.5,&quot;PER_CAPITA_INCOME&quot;:23040,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:20.8,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:17.2},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:3.8000000000000003,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.9,&quot;HARDSHIP_INDEX&quot;:&quot;20&quot;,&quot;Community_Area_Number&quot;:&quot;3&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Uptown&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:22.200000000000003,&quot;PER_CAPITA_INCOME&quot;:35787,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:11.8,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:24.0},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:3.4000000000000004,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.200000000000001,&quot;HARDSHIP_INDEX&quot;:&quot;17&quot;,&quot;Community_Area_Number&quot;:&quot;4&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Lincoln Square&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:25.5,&quot;PER_CAPITA_INCOME&quot;:37524,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:13.4,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:10.9},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:0.30000000000000004,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:5.2,&quot;HARDSHIP_INDEX&quot;:&quot;6&quot;,&quot;Community_Area_Number&quot;:&quot;5&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;North Center&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:26.200000000000003,&quot;PER_CAPITA_INCOME&quot;:57123,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:4.5,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:7.5},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:1.1,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:4.7,&quot;HARDSHIP_INDEX&quot;:&quot;5&quot;,&quot;Community_Area_Number&quot;:&quot;6&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Lake View&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:17.0,&quot;PER_CAPITA_INCOME&quot;:60058,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:2.6,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:11.4},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:0.8,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:5.1000000000000005,&quot;HARDSHIP_INDEX&quot;:&quot;2&quot;,&quot;Community_Area_Number&quot;:&quot;7&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Lincoln Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:21.5,&quot;PER_CAPITA_INCOME&quot;:71551,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:3.6,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:12.3},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:1.9000000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:7.0,&quot;HARDSHIP_INDEX&quot;:&quot;1&quot;,&quot;Community_Area_Number&quot;:&quot;8&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Near North Side&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:22.6,&quot;PER_CAPITA_INCOME&quot;:88669,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:2.5,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:12.9},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:1.1,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:6.5,&quot;HARDSHIP_INDEX&quot;:&quot;8&quot;,&quot;Community_Area_Number&quot;:&quot;9&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Edison Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:35.300000000000004,&quot;PER_CAPITA_INCOME&quot;:40959,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:7.4,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:3.3000000000000003},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:2.0,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:9.0,&quot;HARDSHIP_INDEX&quot;:&quot;21&quot;,&quot;Community_Area_Number&quot;:&quot;10&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Norwood Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:39.5,&quot;PER_CAPITA_INCOME&quot;:32875,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:11.5,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:5.4}],&quot;genId&quot;:&quot;454867645&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"Community_Area_Number\",\"COMMUNITY_AREA_NAME\",\"PERCENT_OF_HOUSING_CROWDED\",\"PERCENT_HOUSEHOLDS_BELOW_POVERTY\",\"PERCENT_AGED_16__UNEMPLOYED\",\"PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA\",\"PERCENT_AGED_UNDER_18_OR_OVER_64\",\"PER_CAPITA_INCOME\",\"HARDSHIP_INDEX\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon9fd9d070248b2522f78f86745de49b79&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc51f4bc82c9b72815f46984c9095bb97&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab2138699297-1\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonf35bd98849eac4ccd8493d49a612bb0b&quot;,&quot;dataInit&quot;:[{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:7.7,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.700000000000001,&quot;HARDSHIP_INDEX&quot;:&quot;39&quot;,&quot;Community_Area_Number&quot;:&quot;1&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Rogers Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:27.5,&quot;PER_CAPITA_INCOME&quot;:23939,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:18.2,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:23.6},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:7.800000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.8,&quot;HARDSHIP_INDEX&quot;:&quot;46&quot;,&quot;Community_Area_Number&quot;:&quot;2&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;West Ridge&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:38.5,&quot;PER_CAPITA_INCOME&quot;:23040,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:20.8,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:17.2},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:3.8000000000000003,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.9,&quot;HARDSHIP_INDEX&quot;:&quot;20&quot;,&quot;Community_Area_Number&quot;:&quot;3&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Uptown&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:22.200000000000003,&quot;PER_CAPITA_INCOME&quot;:35787,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:11.8,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:24.0},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:3.4000000000000004,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:8.200000000000001,&quot;HARDSHIP_INDEX&quot;:&quot;17&quot;,&quot;Community_Area_Number&quot;:&quot;4&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Lincoln Square&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:25.5,&quot;PER_CAPITA_INCOME&quot;:37524,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:13.4,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:10.9},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:0.30000000000000004,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:5.2,&quot;HARDSHIP_INDEX&quot;:&quot;6&quot;,&quot;Community_Area_Number&quot;:&quot;5&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;North Center&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:26.200000000000003,&quot;PER_CAPITA_INCOME&quot;:57123,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:4.5,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:7.5},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:1.1,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:4.7,&quot;HARDSHIP_INDEX&quot;:&quot;5&quot;,&quot;Community_Area_Number&quot;:&quot;6&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Lake View&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:17.0,&quot;PER_CAPITA_INCOME&quot;:60058,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:2.6,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:11.4},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:0.8,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:5.1000000000000005,&quot;HARDSHIP_INDEX&quot;:&quot;2&quot;,&quot;Community_Area_Number&quot;:&quot;7&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Lincoln Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:21.5,&quot;PER_CAPITA_INCOME&quot;:71551,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:3.6,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:12.3},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:1.9000000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:7.0,&quot;HARDSHIP_INDEX&quot;:&quot;1&quot;,&quot;Community_Area_Number&quot;:&quot;8&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Near North Side&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:22.6,&quot;PER_CAPITA_INCOME&quot;:88669,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:2.5,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:12.9},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:1.1,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:6.5,&quot;HARDSHIP_INDEX&quot;:&quot;8&quot;,&quot;Community_Area_Number&quot;:&quot;9&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Edison Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:35.300000000000004,&quot;PER_CAPITA_INCOME&quot;:40959,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:7.4,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:3.3000000000000003},{&quot;PERCENT_OF_HOUSING_CROWDED&quot;:2.0,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:9.0,&quot;HARDSHIP_INDEX&quot;:&quot;21&quot;,&quot;Community_Area_Number&quot;:&quot;10&quot;,&quot;COMMUNITY_AREA_NAME&quot;:&quot;Norwood Park&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:39.5,&quot;PER_CAPITA_INCOME&quot;:32875,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:11.5,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:5.4}],&quot;genId&quot;:&quot;1081273710&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pivotChart'], \n      function(playground, _magicpivotChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpivotChart,\n    \"o\": {\"width\":600,\"height\":400,\"derivedAttributes\":{},\"extraOptions\":{}}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonfba8872525c160f61ca1461f0f9f24ae&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon8911f456a130d3b5c415d04b95938813&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div></div>\n      </div>\n    </div></div>"},"output_type":"execute_result","execution_count":5,"time":"Took: 2 seconds 835 milliseconds, at 2017-1-23 13:23"}]},{"metadata":{"id":"8B2A3493A32D4D759EC9395604A7CAD7"},"cell_type":"markdown","source":"### Crimes Data\n\n- We download the crimes data from the URL to a temporary local file\n- We create a H2OFrame from the local file using the super-fast advanced H2O CSV parser\n- We split the string date into several columns using the RefineDateColumn MRTask that is defined  <a href=\"https://github.com/h2oai/sparkling-water/blob/master/examples/src/main/scala/org/apache/spark/examples/h2o/ChicagoCrimeApp.scala\">here</a>\n- We clean the column titles to avoid white space or + symbols in it\n- We create and register a SQL table from the H2OFrame\n- We show the first 10 rows of the table"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"presentation":{"tabs_state":"{\n  \"tab_id\": \"#tab624209465-0\"\n}","pivot_chart_state":"{\n  \"hiddenAttributes\": [],\n  \"menuLimit\": 200,\n  \"cols\": [],\n  \"rows\": [],\n  \"vals\": [],\n  \"exclusions\": {},\n  \"inclusions\": {},\n  \"unusedAttrsVertical\": 85,\n  \"autoSortUnusedAttrs\": false,\n  \"inclusionsInfo\": {},\n  \"aggregatorName\": \"Count\",\n  \"rendererName\": \"Table\"\n}"},"id":"E61FDB13FC754608AE450B91B117E286"},"cell_type":"code","source":"import org.joda.time.DateTimeConstants._\nval datePattern: String = \"MM/dd/yyyy hh:mm:ss a\"\nval dateTimeZone: String = \"Etc/UTC\"\n\nval crimeURL = new java.net.URL(\"https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/chicagoCrimes10k.csv\")\nval crimeFile = new File(\"/tmp/spark-notebook/chicagoCrimes10k.csv\");\nFileUtils.copyURLToFile(crimeURL, crimeFile) //download the file from URL\n\n//adapt the parse setup\nval parseSetup = water.fvec.H2OFrame.parserSetup(crimeFile)\nval colNames = parseSetup.getColumnNames\nval typeNames = parseSetup.getColumnTypes\ncolNames.indices.foreach { idx =>\n  if (colNames(idx) == \"Date\") typeNames(idx) = Vec.T_STR\n}\nval crimeFrame:H2OFrame = new H2OFrame(parseSetup, crimeFile)\n\nwithLockAndUpdate(crimeFrame){  fr =>\n  // Refine date into multiple columns\n  val dateCol = fr.vec(2)\n  fr.add(new RefineDateColumn(datePattern, dateTimeZone).doIt(dateCol))  \n  // Update names, replace all ' ' by '_'\n  val colNames = fr.names().map(n => n.trim.replace(' ', '_'))\n  fr._names = colNames\n  // Remove Date column\n  fr.remove(2).remove()\n}\n\nval crimeTable = h2oContext.asDataFrame(crimeFrame)(sqlContext)\ncrimeTable.createOrReplaceTempView(\"chicagoCrime\")\n\ncrimeTable.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"import org.joda.time.DateTimeConstants._\ndatePattern: String = MM/dd/yyyy hh:mm:ss a\ndateTimeZone: String = Etc/UTC\ncrimeURL: java.net.URL = https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/chicagoCrimes10k.csv\ncrimeFile: java.io.File = /tmp/spark-notebook/chicagoCrimes10k.csv\nparseSetup: water.parser.ParseSetup = ParserInfo{name='CSV', prior=2147483647, isParallelParseSupported=true}\ncolNames: Array[String] = Array(ID, Case Number, Date, Block, IUCR, Primary Type, Description, Location Description, Arrest, Domestic, Beat, District, Ward, Community Area, FBI Code, X Coordinate, Y Coordinate, Year, Updated On, Latitude, Longitude, Location)\ntypeNames: Array[Byte] = Array(3, 2, 2, 4, 3, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 5, 3, 3, 4)\ncrimeFrame: org.apa..."},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anona841f91c1ef8c5c350a687802459d70f&quot;,&quot;dataInit&quot;:[],&quot;genId&quot;:&quot;624209465&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <div>\n        <ul class=\"nav nav-tabs\" id=\"ul624209465\"><li>\n              <a href=\"#tab624209465-0\"><i class=\"fa fa-table\"/></a>\n            </li><li>\n              <a href=\"#tab624209465-1\"><i class=\"fa fa-cubes\"/></a>\n            </li></ul>\n\n        <div class=\"tab-content\" id=\"tab624209465\"><div class=\"tab-pane\" id=\"tab624209465-0\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon0238f374f34a2a84e6198471bd8ae0fb&quot;,&quot;dataInit&quot;:[{&quot;Y_Coordinate&quot;:1851626,&quot;ID&quot;:9955810,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.747693646, -87.549035389)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1811&quot;,&quot;X_Coordinate&quot;:1198273,&quot;Latitude&quot;:41.747693646,&quot;FBI_Code&quot;:&quot;18&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.54903538900001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144797&quot;,&quot;Description&quot;:&quot;POSS: CANNABIS 30GMS OR LESS&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;7&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;46&quot;,&quot;Primary_Type&quot;:&quot;NARCOTICS&quot;,&quot;District&quot;:&quot;4&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;081XX S COLES AVE&quot;,&quot;Beat&quot;:&quot;422&quot;},{&quot;Y_Coordinate&quot;:1826581,&quot;ID&quot;:9955861,&quot;Location_Description&quot;:&quot;APARTMENT&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.679442289, -87.622850758)&quot;,&quot;Domestic&quot;:&quot;true&quot;,&quot;IUCR&quot;:&quot;486&quot;,&quot;X_Coordinate&quot;:1178335,&quot;Latitude&quot;:41.679442289,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.622850758,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144838&quot;,&quot;Description&quot;:&quot;DOMESTIC BATTERY SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;34&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;53&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;5&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;118XX S STATE ST&quot;,&quot;Beat&quot;:&quot;522&quot;},{&quot;Y_Coordinate&quot;:1898581,&quot;ID&quot;:9955801,&quot;Location_Description&quot;:&quot;SIDEWALK&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.87777333, -87.755117993)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;2026&quot;,&quot;X_Coordinate&quot;:1141717,&quot;Latitude&quot;:41.877773330000004,&quot;FBI_Code&quot;:&quot;18&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.755117993,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144779&quot;,&quot;Description&quot;:&quot;POSS: PCP&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;29&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;25&quot;,&quot;Primary_Type&quot;:&quot;NARCOTICS&quot;,&quot;District&quot;:&quot;15&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;002XX S LARAMIE AVE&quot;,&quot;Beat&quot;:&quot;1522&quot;},{&quot;Y_Coordinate&quot;:null,&quot;ID&quot;:9956197,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:null,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1811&quot;,&quot;X_Coordinate&quot;:null,&quot;Latitude&quot;:null,&quot;FBI_Code&quot;:&quot;18&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:null,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144787&quot;,&quot;Description&quot;:&quot;POSS: CANNABIS 30GMS OR LESS&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;6&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;42&quot;,&quot;Primary_Type&quot;:&quot;NARCOTICS&quot;,&quot;District&quot;:null,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;006XX E 67TH ST&quot;,&quot;Beat&quot;:&quot;321&quot;},{&quot;Y_Coordinate&quot;:1899372,&quot;ID&quot;:9955846,&quot;Location_Description&quot;:&quot;APARTMENT&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.880025548, -87.771541324)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;610&quot;,&quot;X_Coordinate&quot;:1137239,&quot;Latitude&quot;:41.880025548000006,&quot;FBI_Code&quot;:&quot;5&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.77154132400001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144829&quot;,&quot;Description&quot;:&quot;FORCIBLE ENTRY&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;29&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;25&quot;,&quot;Primary_Type&quot;:&quot;BURGLARY&quot;,&quot;District&quot;:&quot;15&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;0000X S MAYFIELD AVE&quot;,&quot;Beat&quot;:&quot;1513&quot;},{&quot;Y_Coordinate&quot;:1873019,&quot;ID&quot;:9955835,&quot;Location_Description&quot;:&quot;APARTMENT&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.807059405, -87.65206589)&quot;,&quot;Domestic&quot;:&quot;true&quot;,&quot;IUCR&quot;:&quot;486&quot;,&quot;X_Coordinate&quot;:1169986,&quot;Latitude&quot;:41.807059405000004,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.65206589,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144778&quot;,&quot;Description&quot;:&quot;DOMESTIC BATTERY SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;3&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;61&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;9&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;010XX W 48TH ST&quot;,&quot;Beat&quot;:&quot;933&quot;},{&quot;Y_Coordinate&quot;:1943222,&quot;ID&quot;:9955872,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.999814056, -87.669342967)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1320&quot;,&quot;X_Coordinate&quot;:1164732,&quot;Latitude&quot;:41.999814056000005,&quot;FBI_Code&quot;:&quot;14&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.669342967,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144822&quot;,&quot;Description&quot;:&quot;TO VEHICLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;40&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;1&quot;,&quot;Primary_Type&quot;:&quot;CRIMINAL DAMAGE&quot;,&quot;District&quot;:&quot;24&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;015XX W ARTHUR AVE&quot;,&quot;Beat&quot;:&quot;2432&quot;},{&quot;Y_Coordinate&quot;:1914206,&quot;ID&quot;:21752,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.920755683, -87.776067514)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;110&quot;,&quot;X_Coordinate&quot;:1135910,&quot;Latitude&quot;:41.920755683,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.776067514,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144738&quot;,&quot;Description&quot;:&quot;FIRST DEGREE MURDER&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;37&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;19&quot;,&quot;Primary_Type&quot;:&quot;HOMICIDE&quot;,&quot;District&quot;:&quot;25&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;060XX W GRAND AVE&quot;,&quot;Beat&quot;:&quot;2512&quot;},{&quot;Y_Coordinate&quot;:1902088,&quot;ID&quot;:9955808,&quot;Location_Description&quot;:&quot;OTHER&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.886707818, -87.631396356)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;460&quot;,&quot;X_Coordinate&quot;:1175384,&quot;Latitude&quot;:41.886707818000005,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.63139635600001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144775&quot;,&quot;Description&quot;:&quot;SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;42&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;32&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;1&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;001XX W WACKER DR&quot;,&quot;Beat&quot;:&quot;122&quot;},{&quot;Y_Coordinate&quot;:1902088,&quot;ID&quot;:9958275,&quot;Location_Description&quot;:&quot;HOTEL/MOTEL&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.886707818, -87.631396356)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;460&quot;,&quot;X_Coordinate&quot;:1175384,&quot;Latitude&quot;:41.886707818000005,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.63139635600001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY146732&quot;,&quot;Description&quot;:&quot;SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;42&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;32&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;1&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;001XX W WACKER DR&quot;,&quot;Beat&quot;:&quot;122&quot;}],&quot;genId&quot;:&quot;1068015258&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"ID\",\"Case_Number\",\"Block\",\"IUCR\",\"Primary_Type\",\"Description\",\"Location_Description\",\"Arrest\",\"Domestic\",\"Beat\",\"District\",\"Ward\",\"Community_Area\",\"FBI_Code\",\"X_Coordinate\",\"Y_Coordinate\",\"Year\",\"Updated_On\",\"Latitude\",\"Longitude\",\"Location\",\"Day\",\"Month\",\"Year0\",\"WeekNum\",\"WeekDay\",\"Weekend\",\"Season\",\"HourOfDay\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon66d81930552d26e5706aa069b4b55da0&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anona85ce37b59ab8499df6fbfad04697574&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab624209465-1\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonf38461779bfe317a1399802c775bb441&quot;,&quot;dataInit&quot;:[{&quot;Y_Coordinate&quot;:1851626,&quot;ID&quot;:9955810,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.747693646, -87.549035389)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1811&quot;,&quot;X_Coordinate&quot;:1198273,&quot;Latitude&quot;:41.747693646,&quot;FBI_Code&quot;:&quot;18&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.54903538900001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144797&quot;,&quot;Description&quot;:&quot;POSS: CANNABIS 30GMS OR LESS&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;7&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;46&quot;,&quot;Primary_Type&quot;:&quot;NARCOTICS&quot;,&quot;District&quot;:&quot;4&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;081XX S COLES AVE&quot;,&quot;Beat&quot;:&quot;422&quot;},{&quot;Y_Coordinate&quot;:1826581,&quot;ID&quot;:9955861,&quot;Location_Description&quot;:&quot;APARTMENT&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.679442289, -87.622850758)&quot;,&quot;Domestic&quot;:&quot;true&quot;,&quot;IUCR&quot;:&quot;486&quot;,&quot;X_Coordinate&quot;:1178335,&quot;Latitude&quot;:41.679442289,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.622850758,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144838&quot;,&quot;Description&quot;:&quot;DOMESTIC BATTERY SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;34&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;53&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;5&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;118XX S STATE ST&quot;,&quot;Beat&quot;:&quot;522&quot;},{&quot;Y_Coordinate&quot;:1898581,&quot;ID&quot;:9955801,&quot;Location_Description&quot;:&quot;SIDEWALK&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.87777333, -87.755117993)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;2026&quot;,&quot;X_Coordinate&quot;:1141717,&quot;Latitude&quot;:41.877773330000004,&quot;FBI_Code&quot;:&quot;18&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.755117993,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144779&quot;,&quot;Description&quot;:&quot;POSS: PCP&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;29&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;25&quot;,&quot;Primary_Type&quot;:&quot;NARCOTICS&quot;,&quot;District&quot;:&quot;15&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;002XX S LARAMIE AVE&quot;,&quot;Beat&quot;:&quot;1522&quot;},{&quot;Y_Coordinate&quot;:null,&quot;ID&quot;:9956197,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:null,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1811&quot;,&quot;X_Coordinate&quot;:null,&quot;Latitude&quot;:null,&quot;FBI_Code&quot;:&quot;18&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:null,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144787&quot;,&quot;Description&quot;:&quot;POSS: CANNABIS 30GMS OR LESS&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;6&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;42&quot;,&quot;Primary_Type&quot;:&quot;NARCOTICS&quot;,&quot;District&quot;:null,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;006XX E 67TH ST&quot;,&quot;Beat&quot;:&quot;321&quot;},{&quot;Y_Coordinate&quot;:1899372,&quot;ID&quot;:9955846,&quot;Location_Description&quot;:&quot;APARTMENT&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.880025548, -87.771541324)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;610&quot;,&quot;X_Coordinate&quot;:1137239,&quot;Latitude&quot;:41.880025548000006,&quot;FBI_Code&quot;:&quot;5&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.77154132400001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144829&quot;,&quot;Description&quot;:&quot;FORCIBLE ENTRY&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;29&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;25&quot;,&quot;Primary_Type&quot;:&quot;BURGLARY&quot;,&quot;District&quot;:&quot;15&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;0000X S MAYFIELD AVE&quot;,&quot;Beat&quot;:&quot;1513&quot;},{&quot;Y_Coordinate&quot;:1873019,&quot;ID&quot;:9955835,&quot;Location_Description&quot;:&quot;APARTMENT&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.807059405, -87.65206589)&quot;,&quot;Domestic&quot;:&quot;true&quot;,&quot;IUCR&quot;:&quot;486&quot;,&quot;X_Coordinate&quot;:1169986,&quot;Latitude&quot;:41.807059405000004,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.65206589,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144778&quot;,&quot;Description&quot;:&quot;DOMESTIC BATTERY SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;3&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;61&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;9&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;010XX W 48TH ST&quot;,&quot;Beat&quot;:&quot;933&quot;},{&quot;Y_Coordinate&quot;:1943222,&quot;ID&quot;:9955872,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.999814056, -87.669342967)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1320&quot;,&quot;X_Coordinate&quot;:1164732,&quot;Latitude&quot;:41.999814056000005,&quot;FBI_Code&quot;:&quot;14&quot;,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.669342967,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144822&quot;,&quot;Description&quot;:&quot;TO VEHICLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;40&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;1&quot;,&quot;Primary_Type&quot;:&quot;CRIMINAL DAMAGE&quot;,&quot;District&quot;:&quot;24&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;015XX W ARTHUR AVE&quot;,&quot;Beat&quot;:&quot;2432&quot;},{&quot;Y_Coordinate&quot;:1914206,&quot;ID&quot;:21752,&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.920755683, -87.776067514)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;110&quot;,&quot;X_Coordinate&quot;:1135910,&quot;Latitude&quot;:41.920755683,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.776067514,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144738&quot;,&quot;Description&quot;:&quot;FIRST DEGREE MURDER&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;37&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;19&quot;,&quot;Primary_Type&quot;:&quot;HOMICIDE&quot;,&quot;District&quot;:&quot;25&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;Block&quot;:&quot;060XX W GRAND AVE&quot;,&quot;Beat&quot;:&quot;2512&quot;},{&quot;Y_Coordinate&quot;:1902088,&quot;ID&quot;:9955808,&quot;Location_Description&quot;:&quot;OTHER&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.886707818, -87.631396356)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;460&quot;,&quot;X_Coordinate&quot;:1175384,&quot;Latitude&quot;:41.886707818000005,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.63139635600001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY144775&quot;,&quot;Description&quot;:&quot;SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;42&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;32&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;1&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;001XX W WACKER DR&quot;,&quot;Beat&quot;:&quot;122&quot;},{&quot;Y_Coordinate&quot;:1902088,&quot;ID&quot;:9958275,&quot;Location_Description&quot;:&quot;HOTEL/MOTEL&quot;,&quot;WeekDay&quot;:&quot;7&quot;,&quot;Location&quot;:&quot;(41.886707818, -87.631396356)&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;460&quot;,&quot;X_Coordinate&quot;:1175384,&quot;Latitude&quot;:41.886707818000005,&quot;FBI_Code&quot;:null,&quot;Year0&quot;:&quot;2015&quot;,&quot;Longitude&quot;:-87.63139635600001,&quot;Month&quot;:&quot;2&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;Updated_On&quot;:1423957419000,&quot;WeekNum&quot;:&quot;6&quot;,&quot;Case_Number&quot;:&quot;HY146732&quot;,&quot;Description&quot;:&quot;SIMPLE&quot;,&quot;HourOfDay&quot;:&quot;23&quot;,&quot;Ward&quot;:&quot;42&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;8&quot;,&quot;Weekend&quot;:&quot;1&quot;,&quot;Community_Area&quot;:&quot;32&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;District&quot;:&quot;1&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;Block&quot;:&quot;001XX W WACKER DR&quot;,&quot;Beat&quot;:&quot;122&quot;}],&quot;genId&quot;:&quot;1211922100&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pivotChart'], \n      function(playground, _magicpivotChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpivotChart,\n    \"o\": {\"width\":600,\"height\":400,\"derivedAttributes\":{},\"extraOptions\":{}}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon5c0d3713ae62ea209a815219335b58ca&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon4a2f5b96d42e20beab1bddc1939e9e2b&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div></div>\n      </div>\n    </div></div>"},"output_type":"execute_result","execution_count":6,"time":"Took: 4 seconds 982 milliseconds, at 2017-1-23 13:23"}]},{"metadata":{"id":"F610EEC9C16240CAB0B018BDF06D59BD"},"cell_type":"markdown","source":"### Geolocation of the crime scenes\n"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"6F0A4D8F287D4E588708B0002DE1D4A6"},"cell_type":"code","source":"case class coord(Latitude:Double, Longitude:Double, Community_Area:Byte)\nval rddForDisplay = crimeTable.rdd.map(row => coord(row.getAs[Double](\"Latitude\"), row.getAs[Double](\"Longitude\"), row.getAs[Byte](\"Community_Area\")) ).filter(_.Latitude!=0)","outputs":[{"name":"stdout","output_type":"stream","text":"defined class coord\nrddForDisplay: org.apache.spark.rdd.RDD[coord] = MapPartitionsRDD[74] at filter at <console>:33\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":51,"time":"Took: 380 milliseconds, at 2017-1-23 13:55"}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"presentation":{"tabs_state":"{\n  \"tab_id\": \"#tab43786339-0\"\n}","pivot_chart_state":"{\n  \"hiddenAttributes\": [],\n  \"menuLimit\": 200,\n  \"cols\": [],\n  \"rows\": [],\n  \"vals\": [],\n  \"exclusions\": {},\n  \"inclusions\": {},\n  \"unusedAttrsVertical\": 85,\n  \"autoSortUnusedAttrs\": false,\n  \"inclusionsInfo\": {},\n  \"aggregatorName\": \"Count\",\n  \"rendererName\": \"Table\"\n}"},"id":"51996F36EE5F46289B43A5F4A53C302A"},"cell_type":"code","source":"GeoPointsChart(rddForDisplay.take(100), latLonFields=Some((\"Latitude\", \"Longitude\")), colorField = Some(\"Community_Area\"))","outputs":[{"name":"stdout","output_type":"stream","text":"res86: notebook.front.widgets.charts.GeoPointsChart[Array[coord]] = <GeoPointsChart widget>\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonbf002717d5cc8389e666036fcd595245&quot;,&quot;dataInit&quot;:[{&quot;Latitude&quot;:41.747693646,&quot;Longitude&quot;:-87.54903538900001,&quot;Community_Area&quot;:&quot;46&quot;},{&quot;Latitude&quot;:41.679442289,&quot;Longitude&quot;:-87.622850758,&quot;Community_Area&quot;:&quot;53&quot;},{&quot;Latitude&quot;:41.877773330000004,&quot;Longitude&quot;:-87.755117993,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.880025548000006,&quot;Longitude&quot;:-87.77154132400001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.807059405000004,&quot;Longitude&quot;:-87.65206589,&quot;Community_Area&quot;:&quot;61&quot;},{&quot;Latitude&quot;:41.999814056000005,&quot;Longitude&quot;:-87.669342967,&quot;Community_Area&quot;:&quot;1&quot;},{&quot;Latitude&quot;:41.920755683,&quot;Longitude&quot;:-87.776067514,&quot;Community_Area&quot;:&quot;19&quot;},{&quot;Latitude&quot;:41.886707818000005,&quot;Longitude&quot;:-87.63139635600001,&quot;Community_Area&quot;:&quot;32&quot;},{&quot;Latitude&quot;:41.886707818000005,&quot;Longitude&quot;:-87.63139635600001,&quot;Community_Area&quot;:&quot;32&quot;},{&quot;Latitude&quot;:41.940007998000006,&quot;Longitude&quot;:-87.65497866700001,&quot;Community_Area&quot;:&quot;6&quot;},{&quot;Latitude&quot;:41.788671493,&quot;Longitude&quot;:-87.73513186800001,&quot;Community_Area&quot;:&quot;62&quot;},{&quot;Latitude&quot;:41.981242424,&quot;Longitude&quot;:-87.65497516100001,&quot;Community_Area&quot;:&quot;77&quot;},{&quot;Latitude&quot;:41.798026245,&quot;Longitude&quot;:-87.693771907,&quot;Community_Area&quot;:&quot;63&quot;},{&quot;Latitude&quot;:41.722261427,&quot;Longitude&quot;:-87.66012736600001,&quot;Community_Area&quot;:&quot;73&quot;},{&quot;Latitude&quot;:41.766831334,&quot;Longitude&quot;:-87.68437891800001,&quot;Community_Area&quot;:&quot;66&quot;},{&quot;Latitude&quot;:41.802252786000004,&quot;Longitude&quot;:-87.715904459,&quot;Community_Area&quot;:&quot;62&quot;},{&quot;Latitude&quot;:41.963690182,&quot;Longitude&quot;:-87.654918709,&quot;Community_Area&quot;:&quot;3&quot;},{&quot;Latitude&quot;:41.89263468,&quot;Longitude&quot;:-87.75536594900001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.881638403000004,&quot;Longitude&quot;:-87.75046353900001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.876661931,&quot;Longitude&quot;:-87.737936176,&quot;Community_Area&quot;:&quot;26&quot;},{&quot;Latitude&quot;:41.925097525000005,&quot;Longitude&quot;:-87.664139582,&quot;Community_Area&quot;:&quot;7&quot;},{&quot;Latitude&quot;:41.867246866,&quot;Longitude&quot;:-87.62756712800001,&quot;Community_Area&quot;:&quot;33&quot;},{&quot;Latitude&quot;:41.938619472,&quot;Longitude&quot;:-87.641647844,&quot;Community_Area&quot;:&quot;6&quot;},{&quot;Latitude&quot;:41.797442646,&quot;Longitude&quot;:-87.726314625,&quot;Community_Area&quot;:&quot;62&quot;},{&quot;Latitude&quot;:41.745366436000005,&quot;Longitude&quot;:-87.64403385600001,&quot;Community_Area&quot;:&quot;71&quot;},{&quot;Latitude&quot;:41.887164115000004,&quot;Longitude&quot;:-87.756748379,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.719802907,&quot;Longitude&quot;:-87.555037528,&quot;Community_Area&quot;:&quot;51&quot;},{&quot;Latitude&quot;:41.779209498,&quot;Longitude&quot;:-87.601497818,&quot;Community_Area&quot;:&quot;42&quot;},{&quot;Latitude&quot;:41.937780033,&quot;Longitude&quot;:-87.748853639,&quot;Community_Area&quot;:&quot;19&quot;},{&quot;Latitude&quot;:41.808501109000005,&quot;Longitude&quot;:-87.663898247,&quot;Community_Area&quot;:&quot;61&quot;},{&quot;Latitude&quot;:41.891466644000005,&quot;Longitude&quot;:-87.745831007,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.880802398,&quot;Longitude&quot;:-87.728368548,&quot;Community_Area&quot;:&quot;26&quot;},{&quot;Latitude&quot;:41.849457581,&quot;Longitude&quot;:-87.716004962,&quot;Community_Area&quot;:&quot;30&quot;},{&quot;Latitude&quot;:41.874832089,&quot;Longitude&quot;:-87.747654041,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:42.011524216000005,&quot;Longitude&quot;:-87.67422918,&quot;Community_Area&quot;:&quot;1&quot;},{&quot;Latitude&quot;:41.968746270000004,&quot;Longitude&quot;:-87.68749266500001,&quot;Community_Area&quot;:&quot;4&quot;},{&quot;Latitude&quot;:41.767468878,&quot;Longitude&quot;:-87.646755494,&quot;Community_Area&quot;:&quot;68&quot;},{&quot;Latitude&quot;:41.859562985000004,&quot;Longitude&quot;:-87.72390671100001,&quot;Community_Area&quot;:&quot;29&quot;},{&quot;Latitude&quot;:42.007753953000005,&quot;Longitude&quot;:-87.668561314,&quot;Community_Area&quot;:&quot;1&quot;},{&quot;Latitude&quot;:41.975793299,&quot;Longitude&quot;:-87.714378174,&quot;Community_Area&quot;:&quot;13&quot;},{&quot;Latitude&quot;:42.007777573000006,&quot;Longitude&quot;:-87.66177620900001,&quot;Community_Area&quot;:&quot;1&quot;},{&quot;Latitude&quot;:41.879516787,&quot;Longitude&quot;:-87.737039397,&quot;Community_Area&quot;:&quot;26&quot;},{&quot;Latitude&quot;:41.915510813000004,&quot;Longitude&quot;:-87.69577104700001,&quot;Community_Area&quot;:&quot;22&quot;},{&quot;Latitude&quot;:41.811087089000004,&quot;Longitude&quot;:-87.696880976,&quot;Community_Area&quot;:&quot;58&quot;},{&quot;Latitude&quot;:41.752065657,&quot;Longitude&quot;:-87.549487907,&quot;Community_Area&quot;:&quot;46&quot;},{&quot;Latitude&quot;:41.949258926000006,&quot;Longitude&quot;:-87.71783678,&quot;Community_Area&quot;:&quot;16&quot;},{&quot;Latitude&quot;:41.766831334,&quot;Longitude&quot;:-87.68437891800001,&quot;Community_Area&quot;:&quot;66&quot;},{&quot;Latitude&quot;:41.938683002000005,&quot;Longitude&quot;:-87.74672465500001,&quot;Community_Area&quot;:&quot;19&quot;},{&quot;Latitude&quot;:41.922912551,&quot;Longitude&quot;:-87.71443020800001,&quot;Community_Area&quot;:&quot;22&quot;},{&quot;Latitude&quot;:41.843208762,&quot;Longitude&quot;:-87.620267541,&quot;Community_Area&quot;:&quot;35&quot;},{&quot;Latitude&quot;:41.879516424,&quot;Longitude&quot;:-87.73696963100001,&quot;Community_Area&quot;:&quot;26&quot;},{&quot;Latitude&quot;:41.903824846,&quot;Longitude&quot;:-87.643371681,&quot;Community_Area&quot;:&quot;8&quot;},{&quot;Latitude&quot;:41.893574736000005,&quot;Longitude&quot;:-87.75785502500001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.868079164,&quot;Longitude&quot;:-87.710744612,&quot;Community_Area&quot;:&quot;29&quot;},{&quot;Latitude&quot;:41.780642168,&quot;Longitude&quot;:-87.70089253,&quot;Community_Area&quot;:&quot;66&quot;},{&quot;Latitude&quot;:41.778237196,&quot;Longitude&quot;:-87.615722993,&quot;Community_Area&quot;:&quot;69&quot;},{&quot;Latitude&quot;:42.003392527,&quot;Longitude&quot;:-87.67315785400001,&quot;Community_Area&quot;:&quot;1&quot;},{&quot;Latitude&quot;:41.781463509000005,&quot;Longitude&quot;:-87.765670844,&quot;Community_Area&quot;:&quot;64&quot;},{&quot;Latitude&quot;:41.821729473000005,&quot;Longitude&quot;:-87.69097896400001,&quot;Community_Area&quot;:&quot;58&quot;},{&quot;Latitude&quot;:41.979045096,&quot;Longitude&quot;:-87.787957382,&quot;Community_Area&quot;:&quot;10&quot;},{&quot;Latitude&quot;:41.766983897,&quot;Longitude&quot;:-87.666452436,&quot;Community_Area&quot;:&quot;67&quot;},{&quot;Latitude&quot;:41.957212991000006,&quot;Longitude&quot;:-87.69942177700001,&quot;Community_Area&quot;:&quot;16&quot;},{&quot;Latitude&quot;:41.890336484,&quot;Longitude&quot;:-87.74915045,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.957466765,&quot;Longitude&quot;:-87.65406558900001,&quot;Community_Area&quot;:&quot;3&quot;},{&quot;Latitude&quot;:41.699628364000006,&quot;Longitude&quot;:-87.63428412,&quot;Community_Area&quot;:&quot;49&quot;},{&quot;Latitude&quot;:41.943080265000006,&quot;Longitude&quot;:-87.718594593,&quot;Community_Area&quot;:&quot;21&quot;},{&quot;Latitude&quot;:41.893785244,&quot;Longitude&quot;:-87.66168617800001,&quot;Community_Area&quot;:&quot;24&quot;},{&quot;Latitude&quot;:42.006615835000005,&quot;Longitude&quot;:-87.663962928,&quot;Community_Area&quot;:&quot;1&quot;},{&quot;Latitude&quot;:41.833829517000005,&quot;Longitude&quot;:-87.64237362600001,&quot;Community_Area&quot;:&quot;60&quot;},{&quot;Latitude&quot;:41.731831645,&quot;Longitude&quot;:-87.585685094,&quot;Community_Area&quot;:&quot;48&quot;},{&quot;Latitude&quot;:41.912296567000006,&quot;Longitude&quot;:-87.77296313900001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.958460121,&quot;Longitude&quot;:-87.70464120300001,&quot;Community_Area&quot;:&quot;16&quot;},{&quot;Latitude&quot;:41.729191706,&quot;Longitude&quot;:-87.62156649100001,&quot;Community_Area&quot;:&quot;44&quot;},{&quot;Latitude&quot;:41.926099501,&quot;Longitude&quot;:-87.70650241,&quot;Community_Area&quot;:&quot;22&quot;},{&quot;Latitude&quot;:41.965165886,&quot;Longitude&quot;:-87.66086709999999,&quot;Community_Area&quot;:&quot;3&quot;},{&quot;Latitude&quot;:41.894923183,&quot;Longitude&quot;:-87.651287185,&quot;Community_Area&quot;:&quot;24&quot;},{&quot;Latitude&quot;:41.750434213000005,&quot;Longitude&quot;:-87.708657775,&quot;Community_Area&quot;:&quot;70&quot;},{&quot;Latitude&quot;:41.895065166,&quot;Longitude&quot;:-87.75409523200001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.902913428000005,&quot;Longitude&quot;:-87.75841034700001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.696506002,&quot;Longitude&quot;:-87.524773286,&quot;Community_Area&quot;:&quot;52&quot;},{&quot;Latitude&quot;:41.699924849000006,&quot;Longitude&quot;:-87.642468734,&quot;Community_Area&quot;:&quot;49&quot;},{&quot;Latitude&quot;:41.72947718,&quot;Longitude&quot;:-87.653296544,&quot;Community_Area&quot;:&quot;73&quot;},{&quot;Latitude&quot;:41.806531543000006,&quot;Longitude&quot;:-87.61937230400001,&quot;Community_Area&quot;:&quot;38&quot;},{&quot;Latitude&quot;:41.976506446,&quot;Longitude&quot;:-87.659721749,&quot;Community_Area&quot;:&quot;77&quot;},{&quot;Latitude&quot;:41.876778463,&quot;Longitude&quot;:-87.75428609400001,&quot;Community_Area&quot;:&quot;25&quot;},{&quot;Latitude&quot;:41.946073244000004,&quot;Longitude&quot;:-87.708251327,&quot;Community_Area&quot;:&quot;21&quot;},{&quot;Latitude&quot;:41.740972099000004,&quot;Longitude&quot;:-87.540528441,&quot;Community_Area&quot;:&quot;46&quot;},{&quot;Latitude&quot;:41.975625571,&quot;Longitude&quot;:-87.72977781600001,&quot;Community_Area&quot;:&quot;13&quot;},{&quot;Latitude&quot;:41.879410287000006,&quot;Longitude&quot;:-87.723035165,&quot;Community_Area&quot;:&quot;26&quot;},{&quot;Latitude&quot;:41.745393629000006,&quot;Longitude&quot;:-87.558700736,&quot;Community_Area&quot;:&quot;46&quot;},{&quot;Latitude&quot;:41.751612033,&quot;Longitude&quot;:-87.561528455,&quot;Community_Area&quot;:&quot;46&quot;},{&quot;Latitude&quot;:41.748794283,&quot;Longitude&quot;:-87.55754948500001,&quot;Community_Area&quot;:&quot;46&quot;},{&quot;Latitude&quot;:41.734126732,&quot;Longitude&quot;:-87.57700835200001,&quot;Community_Area&quot;:&quot;48&quot;},{&quot;Latitude&quot;:41.771493509,&quot;Longitude&quot;:-87.62041717800001,&quot;Community_Area&quot;:&quot;69&quot;},{&quot;Latitude&quot;:41.867921361,&quot;Longitude&quot;:-87.625687301,&quot;Community_Area&quot;:&quot;32&quot;},{&quot;Latitude&quot;:41.96686231,&quot;Longitude&quot;:-87.73587991000001,&quot;Community_Area&quot;:&quot;14&quot;},{&quot;Latitude&quot;:41.974041319,&quot;Longitude&quot;:-87.70707694000001,&quot;Community_Area&quot;:&quot;14&quot;},{&quot;Latitude&quot;:41.767250143000005,&quot;Longitude&quot;:-87.620306537,&quot;Community_Area&quot;:&quot;69&quot;},{&quot;Latitude&quot;:41.815797872000005,&quot;Longitude&quot;:-87.68392884900001,&quot;Community_Area&quot;:&quot;61&quot;},{&quot;Latitude&quot;:41.969353947,&quot;Longitude&quot;:-87.659532352,&quot;Community_Area&quot;:&quot;3&quot;}],&quot;genId&quot;:&quot;1662925753&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/geoPointsChart'], \n      function(playground, _magicgeoPointsChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicgeoPointsChart,\n    \"o\": {\"lat\":\"Latitude\",\"lon\":\"Longitude\",\"width\":600,\"height\":400,\"rField\":null,\"colorField\":\"Community_Area\",\"color\":\"Community_Area\"}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon7b3112ae6fb5739fc961c1d7c81764cf&quot;,&quot;initialValue&quot;:&quot;100&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon300c9dbf59d6c1952f5fc93eb97b2b7b&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>"},"output_type":"execute_result","execution_count":53,"time":"Took: 601 milliseconds, at 2017-1-23 13:55"}]},{"metadata":{"id":"537EEBD150544EAA83E08A93D6207BAA"},"cell_type":"markdown","source":"### Table Join\n\nWe use spark SQL to join crime data with weather and census tables.  We display the first entries of the joined table."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"presentation":{"tabs_state":"{\n  \"tab_id\": \"#tab324897783-0\"\n}","pivot_chart_state":"{\n  \"hiddenAttributes\": [],\n  \"menuLimit\": 200,\n  \"cols\": [],\n  \"rows\": [],\n  \"vals\": [],\n  \"exclusions\": {},\n  \"inclusions\": {},\n  \"unusedAttrsVertical\": 85,\n  \"autoSortUnusedAttrs\": false,\n  \"inclusionsInfo\": {},\n  \"aggregatorName\": \"Count\",\n  \"rendererName\": \"Table\"\n}"},"id":"67D4EC480CB54FF9AED38CFB70F4AEEE"},"cell_type":"code","source":"\nval crimeWeather = sqlContext.sql(\n  \"\"\"SELECT\n    |a.Year, a.Month, a.Day, a.WeekNum, a.HourOfDay, a.Weekend, a.Season, a.WeekDay,\n    |a.IUCR, a.Primary_Type, a.Location_Description, a.Community_Area, a.District,\n    |a.Arrest, a.Domestic, a.Beat, a.Ward, a.FBI_Code,\n    |b.minTemp, b.maxTemp, b.meanTemp,\n    |c.PERCENT_AGED_UNDER_18_OR_OVER_64, c.PER_CAPITA_INCOME, c.HARDSHIP_INDEX,\n    |c.PERCENT_OF_HOUSING_CROWDED, c.PERCENT_HOUSEHOLDS_BELOW_POVERTY,\n    |c.PERCENT_AGED_16__UNEMPLOYED, c.PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA\n    |FROM chicagoCrime a\n    |JOIN chicagoWeather b\n    |ON a.Year = b.year AND a.Month = b.month AND a.Day = b.day\n    |JOIN chicagoCensus c\n    |ON a.Community_Area = c.Community_Area_Number\"\"\".stripMargin)\n\ncrimeWeather.take(10)","outputs":[{"name":"stdout","output_type":"stream","text":"crimeWeather: org.apache.spark.sql.DataFrame = [Year: smallint, Month: tinyint ... 26 more fields]\nres13: Array[org.apache.spark.sql.Row] = Array([2015,1,23,4,22,0,Winter,5,null,WEAPONS VIOLATION,ALLEY,31,12,true,false,1234,25,15,29,31,30,32.6,16444,76,9.600000000000001,25.8,15.8,40.7], [2015,1,23,4,19,0,Winter,5,4625,OTHER OFFENSE,SIDEWALK,31,10,true,false,1034,25,26,29,31,30,32.6,16444,76,9.600000000000001,25.8,15.8,40.7], [2015,1,23,4,19,0,Winter,5,320,ROBBERY,SMALL RETAIL STORE,31,10,false,false,1034,25,3,29,31,30,32.6,16444,76,9.600000000000001,25.8,15.8,40.7], [2015,1,23,4,18,0,Winter,5,1310,CRIMINAL DAMAGE,RESTAURANT,31,12,false,false,1235,25,14,29,31,30,32.6,16444,76,9.600000000000001,25.8,15.8,40.7], [2015,1,23,4,18,0,Winter,5,610,BURGLARY,RESIDENCE,31,12,false,false,1234,25,5,..."},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon8acf9246cbbc0cf22846f52b344ffce8&quot;,&quot;dataInit&quot;:[],&quot;genId&quot;:&quot;324897783&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <div>\n        <ul class=\"nav nav-tabs\" id=\"ul324897783\"><li>\n              <a href=\"#tab324897783-0\"><i class=\"fa fa-table\"/></a>\n            </li><li>\n              <a href=\"#tab324897783-1\"><i class=\"fa fa-cubes\"/></a>\n            </li></ul>\n\n        <div class=\"tab-content\" id=\"tab324897783\"><div class=\"tab-pane\" id=\"tab324897783-0\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon103dce701fdb2767c4da48d6a223f314&quot;,&quot;dataInit&quot;:[{&quot;Location_Description&quot;:&quot;ALLEY&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:null,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;15&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;22&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;WEAPONS VIOLATION&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1234&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;SIDEWALK&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;4625&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;26&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;19&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;OTHER OFFENSE&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;SMALL RETAIL STORE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;320&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;3&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;19&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;ROBBERY&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESTAURANT&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1310&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;14&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;18&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;CRIMINAL DAMAGE&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1235&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESIDENCE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;610&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;5&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;18&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;BURGLARY&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1234&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;TAVERN/LIQUOR STORE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;2210&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;22&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;16&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;LIQUOR LAW VIOLATION&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1233&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;CTA BUS&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;470&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;24&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;16&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;PUBLIC PEACE VIOLATION&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESIDENCE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1305&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;14&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;15&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;CRIMINAL DAMAGE&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1235&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESIDENCE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;true&quot;,&quot;IUCR&quot;:&quot;486&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:null,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;13&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;820&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;6&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;13&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;THEFT&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1234&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8}],&quot;genId&quot;:&quot;1158184918&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"Year\",\"Month\",\"Day\",\"WeekNum\",\"HourOfDay\",\"Weekend\",\"Season\",\"WeekDay\",\"IUCR\",\"Primary_Type\",\"Location_Description\",\"Community_Area\",\"District\",\"Arrest\",\"Domestic\",\"Beat\",\"Ward\",\"FBI_Code\",\"minTemp\",\"maxTemp\",\"meanTemp\",\"PERCENT_AGED_UNDER_18_OR_OVER_64\",\"PER_CAPITA_INCOME\",\"HARDSHIP_INDEX\",\"PERCENT_OF_HOUSING_CROWDED\",\"PERCENT_HOUSEHOLDS_BELOW_POVERTY\",\"PERCENT_AGED_16__UNEMPLOYED\",\"PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon62ce5d83051c9be731ab70a4adb34a28&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon08562fc77b8db1ab7f3e1fc08304519b&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab324897783-1\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon4cfb9deee1cd6bdde7dccb614ad78a7e&quot;,&quot;dataInit&quot;:[{&quot;Location_Description&quot;:&quot;ALLEY&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:null,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;15&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;22&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;WEAPONS VIOLATION&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1234&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;SIDEWALK&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;4625&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;26&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;19&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;OTHER OFFENSE&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;SMALL RETAIL STORE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;320&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;3&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;19&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;ROBBERY&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESTAURANT&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1310&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;14&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;18&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;CRIMINAL DAMAGE&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1235&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESIDENCE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;610&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;5&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;18&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;BURGLARY&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1234&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;TAVERN/LIQUOR STORE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;2210&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;22&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;16&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;LIQUOR LAW VIOLATION&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1233&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;CTA BUS&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;470&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;24&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;16&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;PUBLIC PEACE VIOLATION&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;true&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESIDENCE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;1305&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;14&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;15&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;CRIMINAL DAMAGE&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1235&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;RESIDENCE&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;true&quot;,&quot;IUCR&quot;:&quot;486&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:null,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;13&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;BATTERY&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;10&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1034&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8},{&quot;Location_Description&quot;:&quot;STREET&quot;,&quot;WeekDay&quot;:&quot;5&quot;,&quot;maxTemp&quot;:&quot;31&quot;,&quot;minTemp&quot;:&quot;29&quot;,&quot;Domestic&quot;:&quot;false&quot;,&quot;IUCR&quot;:&quot;820&quot;,&quot;PERCENT_OF_HOUSING_CROWDED&quot;:9.600000000000001,&quot;PERCENT_AGED_16__UNEMPLOYED&quot;:15.8,&quot;FBI_Code&quot;:&quot;6&quot;,&quot;Month&quot;:&quot;1&quot;,&quot;Season&quot;:&quot;Winter&quot;,&quot;HARDSHIP_INDEX&quot;:&quot;76&quot;,&quot;WeekNum&quot;:&quot;4&quot;,&quot;HourOfDay&quot;:&quot;13&quot;,&quot;Ward&quot;:&quot;25&quot;,&quot;Year&quot;:&quot;2015&quot;,&quot;Day&quot;:&quot;23&quot;,&quot;Weekend&quot;:&quot;0&quot;,&quot;Community_Area&quot;:&quot;31&quot;,&quot;Primary_Type&quot;:&quot;THEFT&quot;,&quot;PERCENT_AGED_UNDER_18_OR_OVER_64&quot;:32.6,&quot;District&quot;:&quot;12&quot;,&quot;Arrest&quot;:&quot;false&quot;,&quot;PER_CAPITA_INCOME&quot;:16444,&quot;meanTemp&quot;:&quot;30&quot;,&quot;Beat&quot;:&quot;1234&quot;,&quot;PERCENT_AGED_25__WITHOUT_HIGH_SCHOOL_DIPLOMA&quot;:40.7,&quot;PERCENT_HOUSEHOLDS_BELOW_POVERTY&quot;:25.8}],&quot;genId&quot;:&quot;804835135&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pivotChart'], \n      function(playground, _magicpivotChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpivotChart,\n    \"o\": {\"width\":600,\"height\":400,\"derivedAttributes\":{},\"extraOptions\":{}}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon181e8330e3eac9b73ce15bfa055a4214&quot;,&quot;initialValue&quot;:&quot;10&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon68706a9671af26bca5722d6494d44df4&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div></div>\n      </div>\n    </div></div>"},"data_list":{"application/svg+pngbase64":[]},"output_type":"execute_result","execution_count":10,"time":"Took: 2 seconds 968 milliseconds, at 2017-1-23 12:20"}]},{"metadata":{"id":"352D5DA1F4064AB0A93C1E450536B671"},"cell_type":"markdown","source":"### Training/Validation datasets\n\n- We convert the joined table back to an H2O Frame\n- String columns are converted to categorical variables\n- We split the H2OFrame into a training (80%) and a validation (20%) datasets"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"C42F389CD89748EF838FCC70F1DC000A"},"cell_type":"code","source":"val crimeWeatherDF:H2OFrame = crimeWeather\nwithLockAndUpdate(crimeWeatherDF){allStringVecToCategorical}\n\nval frs = splitFrame(crimeWeatherDF, Array[String](\"train.hex\", \"test.hex\"), Array[Double](0.8, 0.2))\nval (train, test) = (frs(0), frs(1))","outputs":[{"name":"stdout","output_type":"stream","text":"crimeWeatherDF: org.apache.spark.h2o.H2OFrame =\nFrame key: frame_rdd_58\n   cols: 28\n   rows: 9999\n chunks: 200\n   size: 666569\n\nfrs: Array[water.fvec.Frame] =\nArray(Frame key: train.hex\n   cols: 28\n   rows: 7993\n chunks: 199\n   size: 618368\n, Frame key: test.hex\n   cols: 28\n   rows: 2006\n chunks: 199\n   size: 480713\n)\ntrain: water.fvec.Frame =\nFrame key: train.hex\n   cols: 28\n   rows: 7993\n chunks: 199\n   size: 618368\n\ntest: water.fvec.Frame =\nFrame key: test.hex\n   cols: 28\n   rows: 2006\n chunks: 199\n   size: 480713\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":11,"time":"Took: 2 seconds 433 milliseconds, at 2017-1-23 12:20"}]},{"metadata":{"id":"AB2BC20A676842A2BC4ECC3C74494251"},"cell_type":"markdown","source":"### Grandient Boosting Model configuration\n\n- We create a GBM model to predict the value of the \"Arrest\" column based on the other data.\n- We train the model\n- We get the model evaluations for training and validation datasets"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"27A373BD7167452388B845EDA5A4D0F8"},"cell_type":"code","source":"import _root_.hex.tree.gbm.GBM\nimport _root_.hex.tree.gbm.GBMModel.GBMParameters\nimport _root_.hex.genmodel.utils.DistributionFamily\nimport _root_.hex.{Model, ModelMetricsBinomial}\nimport water.support.ModelMetricsSupport\n\nval gbmParams = new GBMParameters()\ngbmParams._train = train\ngbmParams._valid = test\ngbmParams._response_column = \"Arrest\"\ngbmParams._ntrees = 10\ngbmParams._max_depth = 6\ngbmParams._distribution = DistributionFamily.bernoulli\n\nval gbm = new GBM(gbmParams)\nval gbmModel = gbm.trainModel.get\n\nval trainMetricsGBM = ModelMetricsSupport.modelMetrics[ModelMetricsBinomial](gbmModel,train)\nval testMetricsGBM = ModelMetricsSupport.modelMetrics[ModelMetricsBinomial](gbmModel, test)","outputs":[{"name":"stdout","output_type":"stream","text":"import _root_.hex.tree.gbm.GBM\nimport _root_.hex.tree.gbm.GBMModel.GBMParameters\nimport _root_.hex.genmodel.utils.DistributionFamily\nimport _root_.hex.{Model, ModelMetricsBinomial}\nimport water.support.ModelMetricsSupport\ngbmParams: hex.tree.gbm.GBMModel.GBMParameters = hex.tree.gbm.GBMModel$GBMParameters@1d0d8af4\ngbmParams._train: water.Key[water.fvec.Frame] = train.hex\ngbmParams._valid: water.Key[water.fvec.Frame] = test.hex\ngbmParams._response_column: String = Arrest\ngbmParams._ntrees: Int = 10\ngbmParams._max_depth: Int = 6\ngbmParams._distribution: hex.genmodel.utils.DistributionFamily = bernoulli\ngbm: hex.tree.gbm.GBM = hex.tree.gbm.GBM@521a87a9\ngbmModel: hex.tree.gbm.GBMModel =\nModel Metrics Type: Binomial\n Description: N/A\n model id: GBM_model_1485170375149_1\n frame id: train.hex\n..."},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":12,"time":"Took: 2 seconds 158 milliseconds, at 2017-1-23 12:23"}]},{"metadata":{"id":"C3F51CFB8A824E4CA5DDB5BA8F8E2148"},"cell_type":"markdown","source":"### Deeplearning Model configuration\n\n- We create a deeplearning model to predict the value of the \"Arrest\" column based on the other data.\n- We train the model\n- We get the model evaluations for training and validation datasets"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"0F3C748663DA41FF8FD14E64EDCB5C67"},"cell_type":"code","source":"import _root_.hex.deeplearning.DeepLearning\nimport _root_.hex.deeplearning.DeepLearningModel\nimport _root_.hex.deeplearning.DeepLearningModel.DeepLearningParameters\nimport _root_.hex.deeplearning.DeepLearningModel.DeepLearningParameters.Activation\nimport _root_.hex.{Model, ModelMetricsBinomial}\nimport water.support.ModelMetricsSupport\n\nval dlParams = new DeepLearningParameters()\ndlParams._train = train\ndlParams._valid = test\ndlParams._response_column = \"Arrest\"\ndlParams._epochs = 10\ndlParams._l1 = 0.0001\ndlParams._l2 = 0.0001\ndlParams._activation = Activation.RectifierWithDropout\ndlParams._hidden = Array(200,200)\n\n// Create a job\nval dl = new DeepLearning(dlParams)\nval dlModel = dl.trainModel.get\n\nval trainMetricsDL = ModelMetricsSupport.modelMetrics[ModelMetricsBinomial](dlModel,train)\nval testMetricsDL = ModelMetricsSupport.modelMetrics[ModelMetricsBinomial](dlModel, test)","outputs":[{"name":"stdout","output_type":"stream","text":"import _root_.hex.deeplearning.DeepLearning\nimport _root_.hex.deeplearning.DeepLearningModel\nimport _root_.hex.deeplearning.DeepLearningModel.DeepLearningParameters\nimport _root_.hex.deeplearning.DeepLearningModel.DeepLearningParameters.Activation\nimport _root_.hex.{Model, ModelMetricsBinomial}\nimport water.support.ModelMetricsSupport\ndlParams: hex.deeplearning.DeepLearningModel.DeepLearningParameters = hex.deeplearning.DeepLearningModel$DeepLearningParameters@6c4bfc0b\ndlParams._train: water.Key[water.fvec.Frame] = train.hex\ndlParams._valid: water.Key[water.fvec.Frame] = test.hex\ndlParams._response_column: String = Arrest\ndlParams._epochs: Double = 10.0\ndlParams._l1: Double = 1.0E-4\ndlParams._l2: Double = 1.0E-4\ndlParams._activation: hex.deeplearning.DeepLearningModel.DeepLearningParame..."},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":13,"time":"Took: 5 seconds 320 milliseconds, at 2017-1-23 12:24"}]},{"metadata":{"id":"8A97FF61DC33476687DC2B0EB3C674FE"},"cell_type":"markdown","source":"### Model evaluation\n\nWe print the performances of the two models"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"BFF0532D980841018A65BF7AB0EA1A16"},"cell_type":"code","source":"println(\n  s\"\"\"Model performance:\n      |  GBM:\n      |    train AUC = ${trainMetricsGBM.auc}\n      |    test  AUC = ${testMetricsGBM.auc}\n      |  DL:\n      |    train AUC = ${trainMetricsDL.auc}\n      |    test  AUC = ${testMetricsDL.auc}\n  \"\"\".stripMargin)","outputs":[{"name":"stdout","output_type":"stream","text":"Model performance:\n  GBM:\n    train AUC = 0.9331019683973867\n    test  AUC = 0.9006151473283248\n  DL:\n    train AUC = 0.9164267214594475\n    test  AUC = 0.8900188777908906\n  \n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":11,"time":"Took: 709 milliseconds, at 2017-1-4 11:49"}]},{"metadata":{"id":"6912684ABF0A4E5D80A57C6EBC880392"},"cell_type":"markdown","source":"# Model testing\n\nWe can now make use of the model to predict the probability of being arrest as function of the date, place and type of crime.\n"},{"metadata":{"id":"01C4622B0E6F45B28E03786783E708DC"},"cell_type":"markdown","source":"### Scoring helper function\n\nWe define a function that takes as input a Crime object and a model and returns the probability of arrestlebt for that crime"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"1BFAE86BD9FF4EF08629B70E31FB49AC"},"cell_type":"code","source":"def scoreEvent(crime: Crime, model: Model[_,_,_], censusTable: DataFrame) (implicit sqlContext: SQLContext, h2oContext: H2OContext): Float = {\n    import h2oContext.implicits._\n    import sqlContext.implicits._\n    // Create a single row table\n    val srdd: DataFrame = sqlContext.sparkContext.parallelize(Seq(crime)).toDF\n    // Join table with census data\n    val row: H2OFrame = censusTable.join(srdd).where('Community_Area === 'Community_Area_Number) //.printSchema\n    // Transform all string columns into categorical\n    withLockAndUpdate(row){allStringVecToCategorical}\n\n    val predictTable = model.score(row)\n    val probOfArrest = predictTable.vec(\"true\").at(0)\n\n    probOfArrest.toFloat\n}","outputs":[{"name":"stdout","output_type":"stream","text":"scoreEvent: (crime: org.apache.spark.examples.h2o.Crime, model: hex.Model[_, _, _], censusTable: org.apache.spark.sql.DataFrame)(implicit sqlContext: org.apache.spark.sql.SQLContext, implicit h2oContext: org.apache.spark.h2o.H2OContext)Float\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":12,"time":"Took: 834 milliseconds, at 2017-1-4 11:49"}]},{"metadata":{"id":"FA02430A8B82444093C3FDCD0F22B5DD"},"cell_type":"markdown","source":"### List of crime\n\nWe manually enter a list of crime to be tested.  Those are encoded under the crime format defined <a href=\"https://github.com/h2oai/sparkling-water/blob/915f4fb7627befd5a6384c90e6d6f71a53b61d02/examples/src/main/scala/org/apache/spark/examples/h2o/ChicagoCrimeApp.scala#L315\"> here</a>\n"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"7880C10D4E014BA4A4EB7689B3694F39"},"cell_type":"code","source":"val crimeExamples = Seq(\n  Crime(\"02/08/2015 11:43:58 PM\", 1811, \"NARCOTICS\", \"STREET\",false, 422, 4, 7, 46, 18),\n  Crime(\"02/08/2015 11:00:39 PM\", 1150, \"DECEPTIVE PRACTICE\", \"RESIDENCE\",false, 923, 9, 14, 63, 11)\n)","outputs":[{"name":"stdout","output_type":"stream","text":"crimeExamples: Seq[org.apache.spark.examples.h2o.Crime] = List(Crime(2015,2,8,6,23,1,Winter,7,1811,NARCOTICS,STREET,false,422,4,7,46,18,None,None,None), Crime(2015,2,8,6,23,1,Winter,7,1150,DECEPTIVE PRACTICE,RESIDENCE,false,923,9,14,63,11,None,None,None))\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":13,"time":"Took: 487 milliseconds, at 2017-1-4 11:49"}]},{"metadata":{"id":"77B7D95CABBD409ABA5231C79E9F6D3B"},"cell_type":"markdown","source":"### Arrest Probability\n\nWe loop on the crimes and use the scoreEvent function to get the probability of arrest for each crime"},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"16E9E962257049888348C17AA62D89A8"},"cell_type":"code","source":"for (crime <- crimeExamples) {\n  val arrestProbGBM = 100*scoreEvent(crime, gbmModel, censusTable)(sqlContext, h2oContext)\n  val arrestProbDL = 100*scoreEvent(crime, dlModel, censusTable)(sqlContext, h2oContext)\n  println(\n    s\"\"\"\n      |Crime: $crime\n      |  Probability of arrest best on DeepLearning: ${arrestProbDL} %\n      |  Probability of arrest best on GBM: ${arrestProbGBM} %\n      |\n    \"\"\".stripMargin)\n}","outputs":[{"name":"stdout","output_type":"stream","text":"\nCrime: Crime(2015,2,8,6,23,1,Winter,7,1811,NARCOTICS,STREET,false,422,4,7,46,18,None,None,None)\n  Probability of arrest best on DeepLearning: 99.992905 %\n  Probability of arrest best on GBM: 75.25859 %\n\n    \n\nCrime: Crime(2015,2,8,6,23,1,Winter,7,1150,DECEPTIVE PRACTICE,RESIDENCE,false,923,9,14,63,11,None,None,None)\n  Probability of arrest best on DeepLearning: 1.4065968 %\n  Probability of arrest best on GBM: 12.035014 %\n\n    \n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":14,"time":"Took: 3 seconds 708 milliseconds, at 2017-1-4 11:49"}]},{"metadata":{"id":"084441D5C84449B498338B4F5D690567"},"cell_type":"markdown","source":"### All done"}],"nbformat":4}